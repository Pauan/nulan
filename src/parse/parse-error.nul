(USE "package:nulan-standard")

(USE "local:parse/source.nul")


(TYPE Parse-Error
  (*parse-error Text Source))


(PROVIDE ($text<< Parse-Error)
  (FUNCTION text<< :: (-> Parse-Error Text)
    [ (*parse-error message source) ]
    : (++
        "Error: " message "\n"
        (indent (++ "(" (text<< source) ")") "  "))))


(FUNCTION parse-error :: (-> Text Source
                           (Result Never Parse-Error))
  [ message a ]
  : (*failure (*parse-error message a)))
